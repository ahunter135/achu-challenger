<ion-card color="privacybg" *ngIf="!http.userSettings.fitBitShare">
  <ion-card-header>
    <ion-grid>
      <ion-row>
        <ion-col>
          <ion-icon name="alert-circle-outline"></ion-icon>
        </ion-col>
        <ion-col size="10">
          <ion-card-subtitle>Privacy Settings</ion-card-subtitle>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col>
          <ion-card-subtitle style="font-size:10px">In order for you to compete with friends you must enable data
            sharing in
            settings.
          </ion-card-subtitle>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col>
          <ion-button expand="block" size="small" (click)="optIn()" color="privacy">Enable Sharing</ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-card-header>
</ion-card>

<ion-card color="friendsbg" *ngIf="friendData.length <= 0">
  <ion-card-header>
    <ion-card-subtitle style="color: black">We noticed you don't have any Fitbit friends! Please invite friends
      through
      your Fitbit application to start competing!</ion-card-subtitle>
  </ion-card-header>
</ion-card>

<ion-card style="width: 100%; padding: 0; margin: 0;" class="my-comp-card">
  <ion-card-header>
    <ion-button fill="clear" style="float: right;" (click)="openCompetition()">
      <ion-icon slot="icon-only" name="information-circle" style="color: #cfcfcf;font-size:20px;"></ion-icon>
    </ion-button>
    <h1 class="title-nb" style="margin-bottom: 0px;">Competition</h1>
    <!-- <h1 class="title" style="margin-top:0px;">Overall Progression</h1> -->
  </ion-card-header>
</ion-card>


  


<ion-card *ngIf="false">
  <ion-card-header style="font-weight: bold; text-decoration: none; color: black;">
    Compete with your influencer
  </ion-card-header>
  <ion-card-content style="padding: 0 !important;">
    <ion-grid>
      <ion-row>
        <ion-col class="ion-align-self-start">
          <ion-row>
            <ion-col>
              <ion-text style="font-weight: bold; font-size: 15px">
                {{influencerData[1].name}}</ion-text>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col class="ion-align-self-center">
              <canvas #infCanvas style="width: 90%; height: 90%;"></canvas>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col>
              <ion-text style="font-weight: bold; font-size: 20px">
                {{influencerData[1].overallCompletion}}%</ion-text>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col>
              <ion-text style="font-size: 10px;">Overall Completion</ion-text>
            </ion-col>
          </ion-row>
          <ion-row *ngFor="let goal of influencerData[1].goals">
            <ion-col>
              <ion-text style="font-size: 12px;">{{goal.goalType | goalType}}:</ion-text>
            </ion-col>
            <ion-col>
              <ion-text style="font-size: 12px;">{{(goal.progress / goal.goal) * 100 | number:'1.0-0'}}%
              </ion-text>
            </ion-col>
          </ion-row>
        </ion-col>
        <ion-col class="ion-align-self-end">
          <ion-row>
            <ion-col>
              <ion-text style="font-weight: bold; font-size: 15px">{{influencerData[0].name}}</ion-text>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col class="ion-align-self-center">
              <canvas #perCanvas style="width: 90%; height: 90%;"></canvas>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col>
              <ion-text style="font-weight: bold; font-size: 20px">{{influencerData[0].overallCompletion}}%</ion-text>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col>
              <ion-text style="font-size: 9px;">Overall Completion</ion-text>
            </ion-col>
          </ion-row>
          <ion-row *ngFor="let goal of influencerData[0].goals">
            <ion-col>
              <ion-text style="font-size: 12px;">{{goal.goalType | goalType}}:</ion-text>
            </ion-col>
            <ion-col>
              <ion-text style="font-size: 12px;">{{(goal.progress / goal.goal) * 100 | number:'1.0-0'}}%
              </ion-text>
            </ion-col>
          </ion-row>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-card-content>
</ion-card>

<ion-card *ngIf="friendData.length > 0 && http.userSettings.fitBitShare" style="padding-top:0px!important;">
  <ion-card-content style="padding: 0 !important;">
    <ion-item (click)="expandItem(item)" *ngFor="let item of friendData; index as i" lines="none"
      style="padding: 0 !important;">
      <ion-label>
        <ion-grid fixed>
          <ion-row>
            <ion-col size="2" class="ion-align-self-center">
              <img src="../../assets/images/Ribbon_1.png" *ngIf="i == 0" style="margin: auto; display: block">
              <img src="../../assets/images/Ribbon_2.png" *ngIf="i == 1"
                style="width: 70%; margin: auto; display: block">
              <img src="../../assets/images/Ribbon_3.png" *ngIf="i == 2"
                style="width: 70%; margin: auto; display: block">
            </ion-col>
            <ion-col size="7" class="ion-align-self-center">
              <ion-text style="font-size: 14px; color: black">{{item.name}}</ion-text>
              <br>
              <ion-text style="font-size: 10px; color: gray;">Overall Completion</ion-text>



            </ion-col>
            <ion-col size="2" class="ion-align-self-center bar" style="text-align: right;">
              {{(item.overallCompletion / 100) * 100 | number}}%

            </ion-col>
            <ion-col size="1" class="ion-align-self-center">
              <ion-icon *ngIf="!item.expanded" name="chevron-forward" style="float: right"></ion-icon>
              <ion-icon *ngIf="item.expanded" name="chevron-up" style="float: right"></ion-icon>
            </ion-col>

          </ion-row>

          <ion-row>
            <ion-col size=2>



            </ion-col>
            <ion-col>
              <ion-progress-bar value="{{item.overallCompletion / 100}}" reversed="false" color="primary">
              </ion-progress-bar>
            </ion-col>
          </ion-row>

        </ion-grid>

        <app-expandable expandHeight="200px" [expanded]="item.expanded">
          <div class="bar" *ngFor="let goal of item.goals">



            <ion-text style="font-size: 12px; font-weight: bold; float: left">
              {{goal.goalType | goalType}}
            </ion-text>
            <ion-text style="font-size: 12px; float: right">{{(goal.progress / goal.goal) * 100 | number:'1.0-0'}}%
            </ion-text>
            <ion-progress-bar value="{{goal.progress / goal.goal}}" reversed="false" color="primary">
            </ion-progress-bar>

          </div>
        </app-expandable>
      </ion-label>
    </ion-item>
  </ion-card-content>
</ion-card>

<ion-card *ngIf="history.length > 0 && friendData.length > 0">
  <ion-card-content>
    <span>
      <strong>History</strong>
    </span>
    <br>
    <ion-grid>
      <ion-row>
        <ion-col *ngFor="let data of history">
          <img src="../../assets/images/Ribbon_1.png" *ngIf="data.rank == 1">
          <img src="../../assets/images/Ribbon_2.png" *ngIf="data.rank == 2" style="width: 70%;">
          <img src="../../assets/images/Ribbon_3.png" *ngIf="data.rank == 3" style="width: 70%;">
          <ion-icon name="ellipse" *ngIf="data.rank == 0" style="width: 100%; height: 100%; opacity: 0.5;">
          </ion-icon>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col *ngFor="let data of history">
          <span style="display: block; margin: auto; text-align: center;">{{data.day | slice: 0:1}}</span>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-card-content>
</ion-card>

<ion-spinner style="margin: auto; display: block" *ngIf="loading"></ion-spinner>